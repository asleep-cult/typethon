import typing

import enum

from . import types
from ..syntax import ast


class ContextFlags(enum.IntFlag):
    NONE = 0
    ALLOW_RETURN = enum.auto()
    ALLOW_LOOP_CONTROL = enum.auto()


class AnalysisContext:
    # TODO: Update function signatures, not everything will have a specific type.
    # Preserve symbols for name hooks, preserve scopes for functions/classes?
    # We must be able to create an abstract syntax graph using this class.
    def __init__(self, outer_type: typing.Optional[types.AnalyzedType] = None) -> None:
        self.outer_type = outer_type
        self.flags = ContextFlags.NONE

    def create_inner_context(self, outer_type: types.AnalyzedType) -> typing.Self:
        cls = type(self)
        return cls(outer_type)

    def bool_op_hook(self, type: types.AnalyzedType, node: ast.BoolOpNode) -> None: ...

    def binary_op_hook(self, type: types.AnalyzedType, node: ast.BinaryOpNode) -> None: ...

    def unary_op_hook(self, type: types.AnalyzedType, node: ast.UnaryOperator) -> None: ...

    def lambda_hook(self, type: types.AnalyzedType, node: ast.LambdaNode) -> None: ...

    def if_exp_hook(self, type: types.AnalyzedType, node: ast.IfExpNode) -> None: ...

    def dict_hook(self, type: types.AnalyzedType, node: ast.DictNode) -> None: ...

    def set_hook(self, type: types.AnalyzedType, node: ast.SetNode) -> None: ...

    def list_comp_hook(self, type: types.AnalyzedType, node: ast.ListCompNode) -> None: ...

    def set_comp_hook(self, type: types.AnalyzedType, node: ast.SetCompNode) -> None: ...

    def dict_comp_hook(self, type: types.AnalyzedType, node: ast.DictCompNode) -> None: ...

    def generator_exp_hook(self, type: types.AnalyzedType, node: ast.GeneratorExpNode) -> None: ...

    def await_hook(self, type: types.AnalyzedType, node: ast.AwaitNode) -> None: ...

    def yield_hook(self, type: types.AnalyzedType, node: ast.YieldNode) -> None: ...

    def yield_from_hook(self, type: types.AnalyzedType, node: ast.YieldFromNode) -> None: ...

    def compare_hook(self, type: types.AnalyzedType, node: ast.CompareNode) -> None: ...

    def call_hook(self, type: types.AnalyzedType, node: ast.CallNode) -> None: ...

    def formatted_value_hook(self, type: types.AnalyzedType, node: ast.FormattedValueNode) -> None: ...

    def constant_hook(self, type: types.AnalyzedType, node: ast.ConstantNode) -> None: ...

    def attribute_hook(self, type: types.AnalyzedType, node: ast.AttributeNode) -> None: ...

    def subscript_hook(self, type: types.AnalyzedType, node: ast.SubscriptNode) -> None: ...

    def starred_hook(self, type: types.AnalyzedType, node: ast.StarredNode) -> None: ...

    def name_hook(self, type: types.AnalyzedType, node: ast.NameNode) -> None: ...

    def list_hook(self, type: types.AnalyzedType, node: ast.ListNode) -> None: ...

    def tuple_hook(self, type: types.AnalyzedType, node: ast.TupleNode) -> None: ...

    def slice_hook(self, type: types.AnalyzedType, node: ast.SliceNode) -> None: ...    

    def function_def_hook(self, type: types.AnalyzedType, node: ast.FunctionDefNode) -> None: ...

    def class_def_hook(self, type: types.AnalyzedType, node: ast.ClassDefNode) -> None: ...

    def return_hook(self, type: types.AnalyzedType, node: ast.ReturnNode) -> None: ...

    def delete_hook(self, type: types.AnalyzedType, node: ast.DeleteNode) -> None: ...

    def assign_hook(self, type: types.AnalyzedType, node: ast.AssignNode) -> None: ...

    def aug_assign_hook(self, type: types.AnalyzedType, node: ast.AugAssignNode) -> None: ...

    def ann_assign_hook(self, type: types.AnalyzedType, node: ast.AnnAssignNode) -> None: ...

    def for_hook(self, type: types.AnalyzedType, node: ast.ForNode) -> None: ...

    def while_hook(self, type: types.AnalyzedType, node: ast.WhileNode) -> None: ...

    def if_hook(self, type: types.AnalyzedType, node: ast.IfNode) -> None: ...

    def with_hook(self, type: types.AnalyzedType, node: ast.WithNode) -> None: ...

    def raise_hook(self, type: types.AnalyzedType, node: ast.RaiseNode) -> None: ...

    def try_hook(self, type: types.AnalyzedType, node: ast.TryNode) -> None: ...

    def assert_hook(self, type: types.AnalyzedType, node: ast.AssertNode) -> None: ...

    def import_hook(self, type: types.AnalyzedType, node: ast.ImportNode) -> None: ...

    def import_from_hook(self, type: types.AnalyzedType, node: ast.ImportFromNode) -> None: ...

    def global_hook(self, type: types.AnalyzedType, node: ast.GlobalNode) -> None: ...

    def nonlocal_hook(self, type: types.AnalyzedType, node: ast.NonlocalNode) -> None: ...

    def expr_hook(self, type: types.AnalyzedType, node: ast.ExprNode) -> None: ...

    def pass_hook(self, type: types.AnalyzedType, node: ast.PassNode) -> None: ...

    def break_hook(self, type: types.AnalyzedType, node: ast.BreakNode) -> None: ...

    def continue_hook(self, type: types.AnalyzedType, node: ast.ContinueNode) -> None: ...
